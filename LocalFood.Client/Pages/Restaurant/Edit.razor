@page "/restaurants/edit/{Id:int}"
@using LocalFood.Client.Models
@using Microsoft.AspNetCore.Components.Forms
@inject HttpClient Http
@inject NavigationManager Nav

<h3>Edit Restaurant</h3>

<EditForm Model="model" OnValidSubmit="Update">
  <DataAnnotationsValidator />
  <div class="mb-3">
    <label>Name</label>
    <InputText class="form-control" @bind-Value="model.Name" />
  </div>
  <div class="mb-3">
    <label>Address</label>
    <InputText class="form-control" @bind-Value="model.Address" />
  </div>
  <div class="mb-3">
    <label>Description</label>
    <InputTextArea class="form-control" @bind-Value="model.Description" />
  </div>
  <button class="btn btn-primary">Update</button>
</EditForm>

@code {
  [Parameter] public int Id { get; set; }
  RestaurantDto model = new();

  protected override async Task OnInitializedAsync()
  {
    model = await Http.GetFromJsonAsync<RestaurantDto>($"api/restaurants/{Id}");
  }

  async Task Update()
  {
    await Http.PutAsJsonAsync($"api/restaurants/{Id}", model);
    Nav.NavigateTo("/restaurants");
  }
}
